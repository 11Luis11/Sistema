{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 207, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 238, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/components/ui/tabs.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as TabsPrimitive from '@radix-ui/react-tabs'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Tabs({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\r\n  return (\r\n    <TabsPrimitive.Root\r\n      data-slot=\"tabs\"\r\n      className={cn('flex flex-col gap-2', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsList({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\r\n  return (\r\n    <TabsPrimitive.List\r\n      data-slot=\"tabs-list\"\r\n      className={cn(\r\n        'bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsTrigger({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\r\n  return (\r\n    <TabsPrimitive.Trigger\r\n      data-slot=\"tabs-trigger\"\r\n      className={cn(\r\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\r\n  return (\r\n    <TabsPrimitive.Content\r\n      data-slot=\"tabs-content\"\r\n      className={cn('flex-1 outline-none', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 316, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/components/NotificationBell.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState, useRef } from 'react';\r\n\r\ntype Noti = { id:number; type:string; message:string; meta:any; read:boolean; created_at:string; };\r\n\r\nexport default function NotificationBell() {\r\n  const [open, setOpen] = useState(false);\r\n  const [items, setItems] = useState<Noti[]>([]);\r\n  const [count, setCount] = useState(0);\r\n  const lastFetch = useRef(0);\r\n\r\n  async function load(force=false) {\r\n    const now = Date.now();\r\n    if (!force && now - lastFetch.current < 4000) return; // debounce 4s\r\n    lastFetch.current = now;\r\n    try {\r\n      const res = await fetch('/api/notifications');\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        setItems(data.notifications);\r\n        setCount(data.notifications.filter((n:Noti)=>!n.read).length);\r\n      }\r\n    } catch (err) {\r\n      console.error('Load notifications error', err);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    load(true);\r\n    const id = setInterval(() => load(), 8000);\r\n    document.addEventListener('visibilitychange', () => { if (document.visibilityState === 'visible') load(true); });\r\n    return () => { clearInterval(id); };\r\n  }, []);\r\n\r\n  async function markRead(id:number) {\r\n    await fetch(`/api/notifications/${id}`, { method:'PUT' });\r\n    load(true);\r\n  }\r\n\r\n  async function markAll() {\r\n    await fetch('/api/notifications', { method:'PUT' });\r\n    load(true);\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button aria-label=\"Notificaciones\" aria-haspopup=\"true\" aria-expanded={open} onClick={() => { setOpen(!open); if(!open) load(true); }} className=\"relative\">\r\n        <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" role=\"img\" aria-hidden=\"true\"><path d=\"M12 2C9.8 2 8 4 8 6v1.1C6 8.2 4 10.6 4 13v3l-1 1v1h18v-1l-1-1v-3c0-2.4-2-4.8-4-5.9V6c0-2-1.8-4-4-4z\"/></svg>\r\n        {count>0 && <span className=\"absolute -top-1 -right-2 bg-red-600 text-white text-xs px-2 rounded-full\" aria-live=\"polite\">{count}</span>}\r\n      </button>\r\n\r\n      {open && (\r\n        <div className=\"absolute right-0 mt-2 w-80 bg-white shadow rounded z-50 max-h-80 overflow-auto\" role=\"menu\" aria-label=\"Notificaciones\">\r\n          <div className=\"p-2 flex justify-between items-center border-b\">\r\n            <div className=\"text-sm font-semibold\">Notificaciones</div>\r\n            <button onClick={markAll} className=\"text-xs text-blue-600\">Marcar todas</button>\r\n          </div>\r\n          {items.length === 0 && <div className=\"p-3 text-sm text-gray-500\">No hay notificaciones</div>}\r\n          {items.map(n => (\r\n            <div key={n.id} className={`p-3 border-b ${n.read ? 'opacity-70' : ''}`} role=\"menuitem\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <div className=\"font-semibold text-sm\">{n.type}</div>\r\n                  <div className=\"text-sm\">{n.message}</div>\r\n                  <div className=\"text-xs text-gray-400\">{new Date(n.created_at).toLocaleString()}</div>\r\n                </div>\r\n                {!n.read && <button onClick={() => markRead(n.id)} className=\"ml-2 text-sm text-blue-600\">Marcar</button>}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AACA;;;AADA;;AAKe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAS,EAAE;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,YAAY,IAAA,uKAAM,EAAC;IAEzB,eAAe,KAAK,QAAM,KAAK;QAC7B,MAAM,MAAM,KAAK,GAAG;QACpB,IAAI,CAAC,SAAS,MAAM,UAAU,OAAO,GAAG,MAAM,QAAQ,cAAc;QACpE,UAAU,OAAO,GAAG;QACpB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,SAAS,KAAK,aAAa;gBAC3B,SAAS,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC,IAAS,CAAC,EAAE,IAAI,EAAE,MAAM;YAC9D;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,IAAA,0KAAS;sCAAC;YACR,KAAK;YACL,MAAM,KAAK;iDAAY,IAAM;gDAAQ;YACrC,SAAS,gBAAgB,CAAC;8CAAoB;oBAAQ,IAAI,SAAS,eAAe,KAAK,WAAW,KAAK;gBAAO;;YAC9G;8CAAO;oBAAQ,cAAc;gBAAK;;QACpC;qCAAG,EAAE;IAEL,eAAe,SAAS,EAAS;QAC/B,MAAM,MAAM,CAAC,mBAAmB,EAAE,IAAI,EAAE;YAAE,QAAO;QAAM;QACvD,KAAK;IACP;IAEA,eAAe;QACb,MAAM,MAAM,sBAAsB;YAAE,QAAO;QAAM;QACjD,KAAK;IACP;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAO,cAAW;gBAAiB,iBAAc;gBAAO,iBAAe;gBAAM,SAAS;oBAAQ,QAAQ,CAAC;oBAAO,IAAG,CAAC,MAAM,KAAK;gBAAO;gBAAG,WAAU;;kCAChJ,6LAAC;wBAAI,WAAU;wBAAU,SAAQ;wBAAY,MAAK;wBAAM,eAAY;kCAAO,cAAA,6LAAC;4BAAK,GAAE;;;;;;;;;;;oBAClF,QAAM,mBAAK,6LAAC;wBAAK,WAAU;wBAA2E,aAAU;kCAAU;;;;;;;;;;;;YAG5H,sBACC,6LAAC;gBAAI,WAAU;gBAAiF,MAAK;gBAAO,cAAW;;kCACrH,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CAAwB;;;;;;0CACvC,6LAAC;gCAAO,SAAS;gCAAS,WAAU;0CAAwB;;;;;;;;;;;;oBAE7D,MAAM,MAAM,KAAK,mBAAK,6LAAC;wBAAI,WAAU;kCAA4B;;;;;;oBACjE,MAAM,GAAG,CAAC,CAAA,kBACT,6LAAC;4BAAe,WAAW,CAAC,aAAa,EAAE,EAAE,IAAI,GAAG,eAAe,IAAI;4BAAE,MAAK;sCAC5E,cAAA,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAI,WAAU;0DAAyB,EAAE,IAAI;;;;;;0DAC9C,6LAAC;gDAAI,WAAU;0DAAW,EAAE,OAAO;;;;;;0DACnC,6LAAC;gDAAI,WAAU;0DAAyB,IAAI,KAAK,EAAE,UAAU,EAAE,cAAc;;;;;;;;;;;;oCAE9E,CAAC,EAAE,IAAI,kBAAI,6LAAC;wCAAO,SAAS,IAAM,SAAS,EAAE,EAAE;wCAAG,WAAU;kDAA6B;;;;;;;;;;;;2BAPpF,EAAE,EAAE;;;;;;;;;;;;;;;;;AAe1B;GArEwB;KAAA"}},
    {"offset": {"line": 543, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luist/OneDrive/Documentos/Ga/Sistema/app/dashboard/page.tsx"],"sourcesContent":["'use client';\r\nimport { SalesRegistrationTab } from '@/components/sales-registration-tab';\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Card } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Edit2, Trash2, Plus, LogOut, Package, Users, History, TrendingUp, ShoppingCart, Truck } from 'lucide-react';\r\nimport { AddProductForm } from '@/components/add-product-form';\r\nimport { EditProductForm } from '@/components/edit-product-form';\r\nimport { UserManagementTab } from '@/components/user-management-tab';\r\nimport { SuppliersTab } from '@/components/suppliers-tab';\r\nimport { SalesDashboardTab } from '@/components/sales-dashboard-tab';\r\nimport { CustomersManagement } from '@/components/customers-management';\r\nimport NotificationBell from '@/components/NotificationBell';\r\n\r\ninterface User {\r\n  id: number;\r\n  email: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  role: string;\r\n}\r\n\r\ninterface Product {\r\n  id: number;\r\n  code: string;\r\n  name: string;\r\n  description: string;\r\n  category: string;\r\n  price: number;\r\n  current_stock: number;\r\n  size: string;\r\n  color: string;\r\n  gender: string;\r\n}\r\n\r\ninterface InventoryMovement {\r\n  id: number;\r\n  product_id: number;\r\n  product_name: string;\r\n  product_code: string;\r\n  user_name: string;\r\n  movement_type: 'ENTRADA' | 'SALIDA' | 'AJUSTE' | 'DEVOLUCION';\r\n  quantity: number;\r\n  previous_stock: number;\r\n  new_stock: number;\r\n  reason: string;\r\n  created_at: string;\r\n}\r\n\r\nexport default function Dashboard() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [movements, setMovements] = useState<InventoryMovement[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadingMovements, setLoadingMovements] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [movementSearchTerm, setMovementSearchTerm] = useState('');\r\n  const [showAddProduct, setShowAddProduct] = useState(false);\r\n  const [editingProduct, setEditingProduct] = useState<Product | null>(null);\r\n  const [activeTab, setActiveTab] = useState('products');\r\n\r\n  useEffect(() => {\r\n    const userStr = localStorage.getItem('user');\r\n    if (!userStr) {\r\n      router.push('/');\r\n      return;\r\n    }\r\n\r\n    const userData = JSON.parse(userStr);\r\n    setUser(userData);\r\n    fetchDataInParallel();\r\n  }, [router]);\r\n\r\n  async function fetchDataInParallel() {\r\n    try {\r\n      const token = localStorage.getItem('sessionToken');\r\n\r\n      const [productsResponse, movementsResponse] = await Promise.all([\r\n        fetch('/api/products?limit=100'),\r\n        fetch('/api/inventory-movements?limit=100', {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        })\r\n      ]);\r\n\r\n      const [productsData, movementsData] = await Promise.all([\r\n        productsResponse.json(),\r\n        movementsResponse.json()\r\n      ]);\r\n\r\n      if (productsData?.success) {\r\n        setProducts(Array.isArray(productsData.products) ? productsData.products : []);\r\n      }\r\n\r\n      if (movementsData?.success) {\r\n        setMovements(Array.isArray(movementsData.movements) ? movementsData.movements : []);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n      setLoadingMovements(false);\r\n    }\r\n  }\r\n\r\n  async function handleDeleteProduct(id: number) {\r\n    if (!window.confirm('¿Estás seguro que deseas eliminar este producto?')) return;\r\n\r\n    const token = localStorage.getItem('sessionToken');\r\n    const response = await fetch(`/api/products/${id}`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n        'X-User-Role': user?.role || ''\r\n      }\r\n    });\r\n\r\n    if (response.ok) {\r\n      setProducts(prev => prev.filter(p => p.id !== id));\r\n    }\r\n  }\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('sessionToken');\r\n    localStorage.removeItem('user');\r\n    router.push('/');\r\n  };\r\n\r\n  const filteredProducts = (products ?? []).filter(p =>\r\n    p.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    p.code.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const filteredMovements = (movements ?? []).filter(m =>\r\n    m.product_name.toLowerCase().includes(movementSearchTerm.toLowerCase()) ||\r\n    m.product_code.toLowerCase().includes(movementSearchTerm.toLowerCase()) ||\r\n    m.movement_type.toLowerCase().includes(movementSearchTerm.toLowerCase())\r\n  );\r\n\r\n  const canManageProducts = ['Administrator', 'Manager', 'ADM_INV'].includes(user?.role || '');\r\n  const canDeleteProducts = ['Administrator'].includes(user?.role || '');\r\n  const canEditProducts = ['Administrator', 'Manager'].includes(user?.role || '');\r\n  const canManageUsers = ['Manager'].includes(user?.role || '');\r\n\r\n  const getMovementTypeColor = (type: string) => {\r\n    switch (type) {\r\n      case 'ENTRADA':\r\n        return 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300';\r\n      case 'SALIDA':\r\n        return 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300';\r\n      case 'AJUSTE':\r\n        return 'bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300';\r\n      case 'DEVOLUCION':\r\n        return 'bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300';\r\n      default:\r\n        return 'bg-gray-100 text-gray-700';\r\n    }\r\n  };\r\n\r\n  const getMovementIcon = (type: string) => {\r\n    if (type === 'ENTRADA' || type === 'DEVOLUCION') return <TrendingUp className=\"w-4 h-4\" />;\r\n    if (type === 'SALIDA') return <TrendingUp className=\"w-4 h-4 rotate-180\" />;\r\n    return null;\r\n  };\r\n\r\n  const formatDate = (dateString: string) =>\r\n    new Intl.DateTimeFormat('es-PE', {\r\n      year: 'numeric',\r\n      month: '2-digit',\r\n      day: '2-digit',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    }).format(new Date(dateString));\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <header className=\"bg-card border-b border-border shadow-sm sticky top-0 z-10\">\r\n        <div className=\"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <Package className=\"w-8 h-8 text-primary\" />\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-foreground\">YeniJeans</h1>\r\n              <p className=\"text-xs text-muted-foreground\">Sistema de Gestión Empresarial</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"text-right\">\r\n              <p className=\"text-sm font-medium text-foreground\">\r\n                {user?.firstName} {user?.lastName}\r\n              </p>\r\n              <p className=\"text-xs text-primary font-semibold\">{user?.role}</p>\r\n            </div>\r\n            <NotificationBell />\r\n            <Button onClick={handleLogout} variant=\"outline\" size=\"sm\" className=\"gap-2\">\r\n              <LogOut className=\"w-4 h-4\" />\r\n              Cerrar Sesión\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"max-w-7xl mx-auto px-6 py-8\">\r\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n          <TabsList className=\"grid w-full grid-cols-3 lg:grid-cols-7 gap-2 mb-8 h-auto\">\r\n            <TabsTrigger value=\"products\"><Package className=\"w-4 h-4\" />Inventario</TabsTrigger>\r\n            <TabsTrigger value=\"sales\"><ShoppingCart className=\"w-4 h-4\" />Ventas</TabsTrigger>\r\n            <TabsTrigger value=\"sales-dashboard\"><TrendingUp className=\"w-4 h-4\" />Analytics</TabsTrigger>\r\n            <TabsTrigger value=\"suppliers\"><Truck className=\"w-4 h-4\" />Proveedores</TabsTrigger>\r\n            <TabsTrigger value=\"customers\"><Users className=\"w-4 h-4\" />Clientes</TabsTrigger>\r\n            <TabsTrigger value=\"movements\"><History className=\"w-4 h-4\" />Historial</TabsTrigger>\r\n            {canManageUsers && <TabsTrigger value=\"users\"><Users className=\"w-4 h-4\" />Usuarios</TabsTrigger>}\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"products\">\r\n            <Card className=\"p-6\">\r\n              <Input value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />\r\n            </Card>\r\n\r\n            <Card>\r\n              <table className=\"w-full\">\r\n                <tbody>\r\n                  {loading ? (\r\n                    <tr><td>Cargando...</td></tr>\r\n                  ) : (\r\n                    filteredProducts.map(p => (\r\n                      <tr key={p.id}>\r\n                        <td>{p.name}</td>\r\n                        <td>{p.code}</td>\r\n                      </tr>\r\n                    ))\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}